<mat-card class="card">
  <mat-card-title>
    <h1 class="title">Sign up</h1>
  </mat-card-title>
  <mat-card-content *ngIf="!this.isSubmitted || (this.isSubmitted && !this.isSuccessful)"> 
    
    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
      <mat-form-field class="address" appearance="legacy">
        <mat-label>First name*</mat-label>
        <input matInput formControlName="firstName">

      </mat-form-field>
      <div
        *ngIf="registerFormControl.firstName.invalid && (registerFormControl.firstName.dirty || registerFormControl.firstName.touched)">
        <mat-error *ngIf="registerFormControl.firstName.errors?.required">
          First name is required.
        </mat-error>
        <mat-error *ngIf="registerFormControl.firstName.errors?.minlength">
          First name must be a at least 3 characters.
        </mat-error>
        <mat-error *ngIf="registerFormControl.firstName.errors?.maxlength">
          First name must be less then 20 characters.
        </mat-error>
      </div>
      <mat-form-field class="address" appearance="legacy">
        <mat-label>Last name*</mat-label>
        <input matInput formControlName="lastName">
      </mat-form-field>
      <div
        *ngIf="registerFormControl.lastName.invalid && (registerFormControl.lastName.dirty || registerFormControl.lastName.touched)">
        <mat-error *ngIf="registerFormControl.lastName.errors?.required">
          Last name is required.
        </mat-error>
        <mat-error *ngIf="registerFormControl.lastName.errors?.minlength">
          Last name must be a at least 3 characters.
        </mat-error>
        <mat-error *ngIf="registerFormControl.lastName.errors?.maxlength">
          Last name must be less then 20 characters.
        </mat-error>
      </div>

      <br>
      <mat-form-field class="address" appearance="legacy">
        <mat-label>Password</mat-label>
        <input required matInput formControlName="password" type="password">
      </mat-form-field>
      <div
        *ngIf="registerFormControl.password.invalid && (registerFormControl.password.dirty || registerFormControl.password.touched)">
        <mat-error *ngIf="registerFormControl.password.errors?.required">
          Password is required.
        </mat-error>
        <mat-error *ngIf="registerFormControl.password.errors?.minlength">
          Password must be a at least 8 characters.
        </mat-error>
      </div>
      <mat-form-field class="address" appearance="legacy">
        <mat-label>Confirm Password</mat-label>
        <input required matInput formControlName="confirmPassword" type="password">
      </mat-form-field>
      <div
        *ngIf="registerFormControl.confirmPassword.invalid && (registerFormControl.confirmPassword.dirty || registerFormControl.confirmPassword.touched)">
        <mat-error *ngIf="registerFormControl.confirmPassword.hasError('notSame')">
          Confirm password must match .
        </mat-error>
      </div>
      <br>
      <mat-form-field class="address" appearance="legacy">
        <mat-label>Email</mat-label>
        <input required matInput formControlName="email" type="email">
      </mat-form-field>
      <div
        *ngIf="registerFormControl.email.invalid && (registerFormControl.email.dirty || registerFormControl.email.touched)">
        <mat-error *ngIf="registerFormControl.email.errors?.required">
          Email is required.
        </mat-error>
        <mat-error *ngIf="registerFormControl.email.errors?.email">
          Email must be a valid email.
        </mat-error>
      </div>
      <mat-form-field class="address" appearance="legacy">
        <mat-label>Phone</mat-label>
        <input required matInput formControlName="phone">
      </mat-form-field>
      <div
        *ngIf="registerFormControl.phone.invalid && (registerFormControl.phone.dirty || registerFormControl.phone.touched)">
        <mat-error *ngIf="registerFormControl.phone.errors?.required">
          Phone is required.
        </mat-error>
        <mat-error *ngIf="registerFormControl.phone.errors?.maxlength">
          Phone must be less then 9 numbers.
        </mat-error>
        <mat-error *ngIf="registerFormControl.phone.errors?.minlength">
          Phone must be at least 8 numbers.
        </mat-error>
        <mat-error *ngIf="registerFormControl.phone.errors?.pattern">
          Only numbers are allowed.
        </mat-error>
      </div>
      <br>

      <mat-label class="title">Shipping address</mat-label><br>
      <mat-form-field class="address">
        <mat-label>City</mat-label>
        <input matInput formControlName="city" placeholder="Ex. Sofia">
      </mat-form-field>
      <mat-form-field class="address">
        <mat-label>Street Address</mat-label>
        <input matInput formControlName="address" placeholder="Ex. 12, Vasil Levski">
      </mat-form-field>

      <br>
      <mat-label class="title">Profile Image</mat-label><br>
      <mat-form-field appearance="legacy">
        <mat-label class="label">Image</mat-label>
        <input required matInput formControlName="image">
      </mat-form-field>
      <div
        *ngIf="registerFormControl.image.invalid && (registerFormControl.image.dirty || registerFormControl.image.touched)">
        <mat-error *ngIf="registerFormControl.image.errors?.pattern">
          Image URL should be valid (ex. http://example.com/image/path.jpeg).
        </mat-error>
        <mat-error *ngIf="registerFormControl.image.errors?.required">
          Image is required.
        </mat-error>
      </div>
      <br>

      <mat-error *ngIf="this.isSubmitted && !this.isSuccessful">
        {{ this.errorMsg }}
      </mat-error>
      <button type="submit" [disabled]="!registerForm.valid" mat-button color="primary">
        Register
      </button>
    </form>
  </mat-card-content>
  <mat-card-content *ngIf="this.isSuccessful && this.isSubmitted">
    <h2>Thank you for registering!</h2>
    <p>You can now login with your email and password.</p>
    <button type="button" mat-button color="primary" routerLink="/sign-in">Proceed to Login</button>
  </mat-card-content>
</mat-card>
